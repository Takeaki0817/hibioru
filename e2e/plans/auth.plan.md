# Auth機能 E2Eテストプラン

## 概要
認証機能の包括的なE2Eテスト計画。Google OAuth認証、セッション管理、ルート保護、アカウント削除をカバー。

## テストスイート

### 1. ログイン機能 (Requirements 1, 2) - 5テスト
| テスト名 | ステップ | 期待結果 | 要件 |
|---------|---------|---------|------|
| ログイン画面の基本UI表示 | /login にアクセス | ヒビオル、日々を織る、Googleボタン表示 | 2-AC1,2 |
| Googleボタンのアクセシビリティ | ボタン属性確認 | aria-label="Googleでログイン", SVGアイコン | 2-AC3 |
| ログインボタンのローディング状態 | ボタンクリック | ボタン無効化、ローディング表示 | 2-AC4 |
| 認証キャンセル時の挙動 | /auth/callback?error=access_denied | /loginにリダイレクト、エラーなし | 1-AC5 |
| 未認証時のルートアクセス | / にアクセス | /loginにリダイレクト | 7-AC1 |

### 2. 認証状態管理 (Requirement 4) - 3テスト
| テスト名 | ステップ | 期待結果 | 要件 |
|---------|---------|---------|------|
| セッション維持 | ログイン後リロード | 再認証不要 | 4-AC1 |
| 保護ページアクセス | 認証済みで/timeline, /social | 正常表示 | 4-AC2 |
| 認証済みの/loginアクセス | 認証済みで/login | /timelineにリダイレクト | 7-AC3 |

### 3. ログアウト機能 (Requirement 5) - 2テスト
| テスト名 | ステップ | 期待結果 | 要件 |
|---------|---------|---------|------|
| ログアウトボタン表示 | /social→プロフィールタブ | ログアウトボタン表示 | 5-AC1 |
| ログアウト実行 | ログアウトクリック | /loginリダイレクト、セッション削除 | 5-AC2,3 |

### 4. エラーハンドリング (Requirement 6) - 3テスト
| テスト名 | ステップ | 期待結果 | 要件 |
|---------|---------|---------|------|
| エラーメッセージ表示 | /login?error=auth_failed | エラーメッセージ表示 | 6-AC1 |
| 再試行ボタン | エラー時に再試行クリック | エラークリア、ボタン有効 | 6-AC4 |
| アプリ安定性 | 予期しないエラー | クラッシュせず表示 | 6-AC3 |

### 5. ルート保護 (Requirement 7) - 3テスト
| テスト名 | ステップ | 期待結果 | 要件 |
|---------|---------|---------|------|
| 未認証で保護ページ | /timeline, /social | /loginにリダイレクト | 7-AC1 |
| 公開パスアクセス | /login, /lp, /offline | リダイレクトなし | 7-AC2 |
| 認証後リダイレクト | ログイン成功 | /timelineにリダイレクト | 7-AC3 |

### 6. アカウント削除 (Requirement 8) - 5テスト
| テスト名 | ステップ | 期待結果 | 要件 |
|---------|---------|---------|------|
| 削除ボタン表示 | /social→プロフィール | 削除ボタン表示 | 8-AC1 |
| 確認モーダル表示 | 削除ボタンクリック | モーダル表示、delete入力要求 | 8-AC2,3 |
| 不正入力時 | "DELETE"入力 | 削除ボタン無効 | 8-AC8 |
| キャンセル | キャンセルクリック | モーダル閉じ、削除されない | - |
| 削除実行 | "delete"入力→削除 | /loginリダイレクト | 8-AC4,7 |

## 合計: 21テストケース
