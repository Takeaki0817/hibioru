# PR #36 検証チェックリスト

責務分離・共通化・品質改善の包括リファクタリング

---

## 概要

PR #36 の変更に対する潜在的リスクを検証するためのテスト項目。
マージ前および本番デプロイ前に実施すること。

---

## 1. エントリ機能（entry）

### 1.1 エントリ作成

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | テキストのみ投稿 | 本文入力 → 送信 | 成功オーバーレイ → タイムラインに遷移 | [ ] |
| 2 | 画像付き投稿 | 本文 + 画像添付 → 送信 | 画像アップロード成功、タイムラインに表示 | [ ] |
| 3 | 複数画像投稿 | 3枚の画像を添付 → 送信 | すべての画像が正しく表示 | [ ] |
| 4 | 共有ON投稿 | 共有スイッチON → 送信 | ソーシャルフィードに表示 | [ ] |
| 5 | Cmd+Enter送信 | テキスト入力 → Cmd+Enter | 送信が実行される | [ ] |
| 6 | 下書き保存 | テキスト入力 → ページ離脱 → 再訪問 | 下書きが復元される | [ ] |
| 7 | バリデーション | 空の状態で送信ボタン押下 | ボタンが無効、送信不可 | [ ] |

### 1.2 エントリ編集

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 本文編集 | 既存エントリ → 編集 → 本文変更 → 保存 | 変更が反映 | [ ] |
| 2 | 画像追加 | 既存エントリ → 画像追加 → 保存 | 新画像が追加表示 | [ ] |
| 3 | 画像削除 | 既存エントリ → 画像削除 → 保存 | 画像が削除される | [ ] |
| 4 | 共有状態変更 | 共有ON→OFF（またはその逆） → 保存 | フィードから削除/追加 | [ ] |
| 5 | 編集可能時間 | 作成から24時間以上経過したエントリ | 編集不可の表示 | [ ] |

### 1.3 エントリ削除

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 削除確認ダイアログ | 削除ボタン押下 | 確認ダイアログ表示 | [ ] |
| 2 | 削除キャンセル | ダイアログでキャンセル | ダイアログ閉じる、エントリ残存 | [ ] |
| 3 | 削除実行 | ダイアログで削除確定 | タイムラインに遷移、エントリ削除 | [ ] |
| 4 | 削除中の状態 | 削除ボタン押下直後 | ローディング表示、二重クリック防止 | [ ] |

---

## 2. タイムライン機能（timeline）

### 2.1 表示・スクロール

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 初期表示 | タイムラインページ訪問 | エントリ一覧が表示 | [ ] |
| 2 | 無限スクロール | 下方向にスクロール | 追加データ読み込み | [ ] |
| 3 | 日付グルーピング | 複数日のエントリ表示 | 日付ごとにグループ化 | [ ] |
| 4 | 日付ヘッダー固定 | スクロール中 | 現在日付がヘッダーに表示 | [ ] |
| 5 | 空状態 | エントリ0件のユーザー | 空状態メッセージ表示 | [ ] |
| 6 | スケルトン表示 | 初回読み込み中 | スケルトンアニメーション | [ ] |

### 2.2 初期スクロール

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 新規投稿後 | 投稿完了 → タイムライン | 最新エントリが表示位置 | [ ] |
| 2 | ページリロード | タイムラインでリロード | 適切な位置にスクロール | [ ] |

---

## 3. ソーシャル機能（social）

### 3.1 フィード表示

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | フィード初期表示 | ソーシャルタブ → フィード | フォロー中ユーザーの投稿表示 | [ ] |
| 2 | 達成表示 | フォロー中ユーザーが達成 | 達成アイテム表示 | [ ] |
| 3 | 共有投稿表示 | フォロー中ユーザーが共有 | 共有投稿アイテム表示 | [ ] |
| 4 | 空フィード | フォロー0人 | 空状態メッセージ表示 | [ ] |
| 5 | スケルトン表示 | 読み込み中 | ListSkeleton variant="feed" | [ ] |

### 3.2 Realtime更新 ⚠️ 重要

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 達成リアルタイム受信 | 別タブでフォロー中ユーザーが達成 | フィードに即時反映 | [ ] |
| 2 | 達成削除リアルタイム | フォロー中ユーザーが達成削除 | フィードからexitアニメーションで消去 | [ ] |
| 3 | 共有投稿リアルタイム | フォロー中ユーザーが共有 | フィードに即時反映 | [ ] |
| 4 | 購読解除 | ソーシャルタブ離脱 | Realtime購読が正しく解除 | [ ] |

### 3.3 お祝い機能

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | お祝い実行 | 未お祝いアイテムをクリック | パーティクルエフェクト、状態変更 | [ ] |
| 2 | お祝い取消 | お祝い済みアイテムをクリック | 状態が未お祝いに戻る | [ ] |
| 3 | ローディング中 | お祝いクリック直後 | Loader2表示、二重クリック防止 | [ ] |

### 3.4 フォローリスト

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | フォロー中一覧 | フォロー数クリック | FollowingList表示 | [ ] |
| 2 | フォロワー一覧 | フォロワー数クリック | FollowerList表示 | [ ] |
| 3 | 追加読み込み | リストをスクロール | ページネーション動作 | [ ] |
| 4 | リトライ | エラー発生後リトライボタン | 再取得実行 | [ ] |
| 5 | 空リスト | フォロー0人 | EmptyState表示 | [ ] |

---

## 4. 通知機能（notification）

### 4.1 通知バナー

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | バナー表示 | 未許可ユーザーでログイン | 通知許可バナー表示 | [ ] |
| 2 | 許可ボタン | 許可するボタンクリック | ブラウザ許可ダイアログ表示 | [ ] |
| 3 | 後でボタン | 後でボタンクリック | バナー非表示 | [ ] |
| 4 | アクセシビリティ | スクリーンリーダー | role="alert", aria-live="assertive"が機能 | [ ] |

---

## 5. アクセシビリティ（a11y）

### 5.1 ARIA属性

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | アイコンの非表示 | 装飾的アイコン | aria-hidden="true"が設定 | [ ] |
| 2 | ローディング状態 | 各種読み込み中 | aria-busy="true"が設定 | [ ] |
| 3 | トグル状態 | お祝いボタン | aria-pressed が正しく変化 | [ ] |
| 4 | 画像alt | 添付画像 | 詳細なalt属性 | [ ] |

### 5.2 キーボード操作

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | フォーム送信 | Cmd+Enter / Ctrl+Enter | 送信実行 | [ ] |
| 2 | フォーカス管理 | Tabキー操作 | 論理的な順序でフォーカス移動 | [ ] |

---

## 6. SEO

### 6.1 メタデータ

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 編集ページnoindex | /edit/[id] ページ | robots: noindexが設定 | [ ] |
| 2 | OGP画像 | LPページのOGタグ確認 | og:imageが正しく設定 | [ ] |
| 3 | 外部リンク | 利用規約・プライバシーリンク | rel="external noopener noreferrer" | [ ] |

---

## 7. パフォーマンス

### 7.1 レンダリング

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | 不要な再レンダリング | React DevTools Profiler | 責務分離後も再レンダリング最小 | [ ] |
| 2 | メモリリーク | 長時間使用後 | useEffectクリーンアップが機能 | [ ] |

---

## 8. エラーハンドリング

### 8.1 ログ出力

| # | テスト項目 | 手順 | 期待結果 | 確認 |
|---|-----------|------|----------|------|
| 1 | console.error排除 | 本番ビルド確認 | console.errorが出力されない | [ ] |
| 2 | logger使用 | 開発環境でエラー発生 | loggerでログ出力 | [ ] |

---

## 検証環境

- [ ] ローカル開発環境（localhost:3000）
- [ ] Vercel Preview環境
- [ ] 本番環境（デプロイ後）

## ブラウザ

- [ ] Chrome（最新）
- [ ] Safari（最新）
- [ ] Firefox（最新）
- [ ] モバイルSafari（iOS）
- [ ] モバイルChrome（Android）

---

## 検証結果サマリ

| カテゴリ | 合計 | OK | NG | 未実施 |
|---------|------|----|----|--------|
| エントリ機能 | 14 | | | 14 |
| タイムライン | 8 | | | 8 |
| ソーシャル | 14 | | | 14 |
| 通知機能 | 4 | | | 4 |
| a11y | 6 | | | 6 |
| SEO | 3 | | | 3 |
| パフォーマンス | 2 | | | 2 |
| エラーハンドリング | 2 | | | 2 |
| **合計** | **53** | | | **53** |

---

## 検証担当・日付

| 日付 | 担当 | 環境 | 結果 |
|------|------|------|------|
| | | | |

---

## 発見された問題

| # | カテゴリ | 問題内容 | 重大度 | 対応状況 |
|---|---------|----------|--------|----------|
| | | | | |

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2025-01-11 | PR #36 レビューを元に初版作成 |
