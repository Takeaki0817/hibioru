# テストシナリオ: social機能

## 概要

ソーシャル機能のテストシナリオ。仕様書（`.kiro/specs/social/`）とギャップ分析（`gap-analysis-social.md`）に基づいて、API・フック・コンポーネント層のテストを網羅する。

**重要な未実装ギャップ**:
1. **お祝いプッシュ通知の呼び出し漏れ** - Critical
2. **markAsRead / markAllAsRead** - 未実装
3. **未読バッジ** - 未実装

## ユニットテスト

### API関数テスト

| テスト名 | 対象関数 | テスト内容 | 優先度 |
|---------|---------|-----------|--------|
| 達成チェック・共有投稿 | `checkAndCreateAchievements` | 共有フラグ有りで共有達成を作成 | 高 |
| 達成チェック・当日投稿数 | `checkAndCreateAchievements` | 当日投稿数が閾値を超えたら達成を作成 | 高 |
| 達成チェック・総投稿数 | `checkAndCreateAchievements` | 総投稿数が閾値を超えたら達成を作成 | 高 |
| 達成チェック・継続日数 | `checkAndCreateAchievements` | 継続日数が閾値を超えたら達成を作成 | 高 |
| 達成チェック・重複作成禁止 | `checkAndCreateAchievements` | 同日に同じタイプ・閾値の達成は作成しない | 高 |
| 達成チェック・複数並行作成 | `checkAndCreateAchievements` | 複数の達成条件を満たすと並行して作成 | 中 |
| 達成チェック・認証チェック | `checkAndCreateAchievements` | 未認証時はエラーを返す | 高 |
| 達成チェック・権限チェック | `checkAndCreateAchievements` | 他ユーザーのuserIdで呼び出すとエラー | 高 |
| 達成削除・共有投稿 | `deleteSharedEntryAchievement` | 共有→非共有に変更時に達成を削除 | 中 |
| 達成touch・Realtime更新 | `touchSharedEntryAchievement` | updated_atを更新してRealtimeイベントを発火 | 中 |
| お祝い送信・新規 | `celebrateAchievement` | 達成をお祝いし、通知を作成 | 高 |
| お祝い送信・重複禁止 | `celebrateAchievement` | 既に祝い済みの場合はエラー（ALREADY_CELEBRATED） | 高 |
| **[Critical]** お祝い・プッシュ通知未呼び出し | `celebrateAchievement` | プッシュ通知関数が呼び出されていない（不具合） | **極高** |
| お祝い取消 | `uncelebrateAchievement` | 既に祝い済みの場合は取り消し | 中 |
| お祝い取消・未祝い状態 | `uncelebrateAchievement` | 祝い済みでない場合はエラー（NOT_CELEBRATED） | 中 |
| お祝い数取得 | `getMyCelebrationCount` | 自分の達成への総お祝い数を取得 | 低 |
| フォロー・新規 | `followUser` (authActionClient) | ユーザーをフォローし、通知を作成 | 高 |
| フォロー・自己フォロー禁止 | `followUser` | 自分自身をフォロー時はエラー | 高 |
| フォロー・重複禁止 | `followUser` | 既にフォロー済みの場合はエラー（ALREADY_FOLLOWING） | 高 |
| フォロー・レート制限 | `followUser` | レート制限超過時はエラー | 中 |
| フォロー・プッシュ通知 | `followUser` | フォロー通知を送信（非同期） | 中 |
| フォロー解除 | `unfollowUser` | フォロー関係を削除 | 高 |
| フォロー解除・未フォロー状態 | `unfollowUser` | フォローしていない場合はエラー | 高 |
| フォロー状態確認 | `isFollowing` | フォロー中なら true、未フォロー中なら false | 中 |
| フォロー数取得 | `getFollowCounts` | 自分のフォロー数とフォロワー数を取得 | 中 |
| フォロー中一覧 | `getFollowingList` | フォロー中のユーザー一覧を取得（ページネーション） | 高 |
| フォロワー一覧 | `getFollowerList` | フォロワーのユーザー一覧を取得（ページネーション） | 高 |
| 通知取得 | `getSocialNotifications` | ソーシャル通知を取得（ページネーション） | 高 |
| **[Gap]** 通知既読マーク | `markAsRead` | 通知IDを既読マーク（未実装） | **高** |
| **[Gap]** 全通知既読 | `markAllAsRead` | 全通知を既読マーク（未実装） | **高** |

### フック層テスト

| テスト名 | 対象フック | テスト内容 | 優先度 |
|---------|-----------|-----------|--------|
| フォローボタン・フォロー状態管理 | `use-follow.ts` | フォロー・アンフォロー状態を管理 | 高 |
| フォローボタン・エラー処理 | `use-follow.ts` | エラー時のメッセージ表示 | 中 |
| フォローボタン・ローディング状態 | `use-follow.ts` | 送信中のローディング状態表示 | 中 |
| フォローリスト・無限スクロール | `use-follow-list.ts` | カーソルベースで次ページを読み込み | 高 |
| フォローリスト・エラー時リトライ | `use-follow-list.ts` | エラー時のリトライ機能 | 中 |
| ソーシャルフィード・初期読み込み | `use-social-feed.ts` | フォロー中ユーザーの達成を取得 | 高 |
| ソーシャルフィード・無限スクロール | `use-social-feed.ts` | ページネーションで次のアイテムを読み込み | 高 |
| ソーシャルフィード・キャッシュ | `use-social-feed.ts` | staleTime/gcTime設定に従ってキャッシュ | 中 |
| Realtime購読・達成更新 | `use-achievement-realtime.ts` | 新しい達成をリアルタイム受信して統合 | 高 |
| Realtime購読・アンマウント時に購読解除 | `use-achievement-realtime.ts` | クリーンアップ関数で購読を解除 | 中 |
| お祝いアニメーション | `use-celebration.ts` | パーティクルエフェクト実行と完了コールバック | 高 |
| 通知リスト・初期読み込み | `use-social-notifications.ts` | 未読通知を含む通知リストを取得 | 高 |
| 通知リスト・ページネーション | `use-social-notifications.ts` | 次ページの通知を読み込み | 中 |
| ユーザー検索 | `use-*` (hooks層) | キーワードでユーザーを検索、キャッシュ管理 | 中 |

### ストア層テスト

| テスト名 | 対象ストア | テスト内容 | 優先度 |
|---------|-----------|-----------|--------|
| プロフィール情報保存 | Zustand store | 自分のユーザー名・表示名を保存 | 中 |
| タブ状態管理 | Zustand store | 「みんな」「通知」タブの選択状態を保存 | 低 |

### バリデーション・定数テスト

| テスト名 | 対象 | テスト内容 | 優先度 |
|---------|------|-----------|--------|
| ユーザー名バリデーション・最小長 | `validateUsername` | 3文字未満はエラー | 中 |
| ユーザー名バリデーション・最大長 | `validateUsername` | 20文字超過はエラー | 中 |
| ユーザー名バリデーション・文字種 | `validateUsername` | 英数字・アンダースコア以外はエラー | 中 |
| 表示名バリデーション・最小長 | `validateDisplayName` | 空文字列はエラー | 中 |
| 表示名バリデーション・最大長 | `validateDisplayName` | 50文字超過はエラー | 中 |
| 表示名バリデーション・制御文字除去 | `validateDisplayName` | `<>"'&` 等の危険文字を禁止 | 高 |
| 表示名サニタイズ | `sanitizeDisplayName` | 制御文字を除去して返す | 中 |
| ILIKE検索エスケープ | `escapeIlikeWildcards` | `%` `_` `\` をエスケープ | 中 |
| 達成閾値定数 | `ACHIEVEMENT_THRESHOLDS` | 達成閾値がすべて定義されている | 低 |
| 達成メッセージ生成 | `getAchievementMessage` | タイプと閾値から正しいメッセージを生成 | 低 |

---

## E2Eテスト

### 正常系

#### ユーザー検索・プロフィール表示フロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| ユーザー検索・キーワード検索 | 1. ソーシャルフィードを開く<br>2. 検索ボックスに「user_abc」と入力<br>3. 検索実行 | 候補ユーザーが表示される | 高 |
| ユーザー検索・絞り込み | 1. ユーザー「user_abc」を検索<br>2. 「_ab」で再検索 | マッチしたユーザーのみ表示 | 中 |
| プロフィール表示 | 1. 検索結果から「user_abc」をクリック<br>2. プロフィールページを表示 | アバター、ユーザー名、表示名が表示される | 中 |

#### フォロー・フォロー解除フロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| フォロー・新規フォロー | 1. プロフィールページを開く<br>2. 「フォロー」ボタンをクリック | ボタンが「フォロー中」に変更される | 高 |
| フォロー・通知作成 | 1. ユーザーAがユーザーBをフォロー<br>2. ユーザーBの通知タブを確認 | 「ユーザーAがフォローしました」という通知が表示される | 高 |
| フォロー・プッシュ通知 | 1. プッシュ通知設定が有効な状態<br>2. ユーザーAがユーザーBをフォロー | ブラウザプッシュ通知が表示される | 中 |
| フォロー解除 | 1. フォロー中のユーザーで「フォロー中」ボタンをクリック<br>2. 確認ダイアログで「解除」 | ボタンが「フォロー」に変更される | 高 |
| フォロー数表示 | 1. ソーシャルページを開く<br>2. 自分のフォロー/フォロワー数セクションを確認 | 「フォロー: X」「フォロワー: Y」と表示 | 中 |
| フォロー中一覧 | 1. フォロー数の「フォロー」をクリック<br>2. フォロー中一覧が表示 | フォロー中のユーザーが新しい順に表示される | 中 |
| フォロワー一覧 | 1. フォロー数の「フォロワー」をクリック<br>2. フォロワー一覧が表示 | フォロワーのユーザーが新しい順に表示される | 中 |

#### 共有投稿・達成フロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| 共有投稿・トグルON | 1. 新規投稿フォームを開く<br>2. 「フォロワーに共有」トグルをON<br>3. 投稿を作成 | 投稿が `is_shared=true` で保存される | 高 |
| 共有投稿・達成自動作成 | 1. 「フォロワーに共有」で投稿を作成<br>2. 達成テーブルを確認 | `type: 'shared_entry'` の達成が作成される | 高 |
| 投稿数達成・当日 | 1. 当日投稿数が19件<br>2. 新規投稿を作成<br>3. 達成を確認 | `type: 'daily_posts', threshold: 20` の達成が作成される | 高 |
| 投稿数達成・総投稿 | 1. 総投稿数が99件<br>2. 新規投稿を作成<br>3. 達成を確認 | `type: 'total_posts', threshold: 100` の達成が作成される | 高 |
| 継続達成 | 1. 継続日数が6日<br>2. 当日投稿を記録<br>3. 達成を確認 | `type: 'streak_days', threshold: 7` の達成が作成される | 高 |

#### ソーシャルフィード表示フロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| ソーシャルフィード・初期表示 | 1. ソーシャルページを開く<br>2. 「みんな」タブを選択 | フォロー中ユーザーの達成・共有投稿が時系列順に表示 | 高 |
| ソーシャルフィード・達成表示 | 1. フォロー中のユーザーが達成を獲得<br>2. フィードを確認 | 達成がフィードに表示（「7日継続達成！」等） | 高 |
| ソーシャルフィード・共有投稿表示 | 1. フォロー中のユーザーが共有投稿を作成<br>2. フィードを確認 | 共有投稿がフィードに表示（内容、画像） | 高 |
| ソーシャルフィード・フォロー前達成非表示 | 1. ユーザーAが複数の達成を獲得<br>2. ユーザーBがユーザーAをフォロー<br>3. ユーザーBのフィードを確認 | ユーザーAの直近1件の達成のみ表示（フォロー後の達成は表示）| 高 |
| ソーシャルフィード・無限スクロール | 1. フィード下部までスクロール<br>2. 次ページが自動読み込み | 20件単位で追加読み込みされる | 高 |
| ソーシャルフィード・Realtime更新 | 1. フィードを表示中<br>2. 別窓でフォロー中ユーザーが達成を獲得<br>3. フィード画面を確認 | 新しい達成がリアルタイムに追加される | 高 |

#### お祝い・パーティクルエフェクトフロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| お祝い送信・単一クリック | 1. フィードアイテムをタップ<br>2. お祝いが送信される | アイテムが祝い済み状態に変更（色変更）| 高 |
| お祝い・パーティクルエフェクト | 1. フィードアイテムをタップ<br>2. エフェクトが実行 | パーティクルが放射状に広がるアニメーション表示 | 高 |
| お祝い・通知作成 | 1. ユーザーAが達成をお祝い<br>2. ユーザーB（達成者）の通知タブを確認 | 「ユーザーAがお祝いしました」という通知が表示 | 高 |
| **[Critical]** お祝い・プッシュ通知未送信 | 1. プッシュ通知設定が有効<br>2. 達成をお祝い<br>3. ブラウザ通知を確認 | プッシュ通知が送信されない（バグ） | **極高** |
| お祝い取消 | 1. 祝い済みアイテムを再度タップ<br>2. お祝いが取り消される | アイテムが祝い前状態に戻る（色戻る） | 中 |
| お祝い・重複禁止 | 1. 同じアイテムを連続でタップ | 2回目以降は「既にお祝い済み」エラー | 中 |

#### 通知・既読管理フロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| 通知一覧表示 | 1. ソーシャルページを開く<br>2. 「通知」タブを選択 | お祝い・フォロー通知が表示（新しい順） | 高 |
| 通知・既読マーク | 1. 通知をタップして既読にする<br>2. **[未実装]** 既読マーク関数を呼び出し | 通知が既読状態に変更（視覚的に薄くなる等） | **高** |
| 通知・全既読 | 1. **[未実装]** 「すべて既読」ボタンをクリック<br>2. すべての通知が既読になる | 全通知が既読状態に変更 | **中** |
| **[Gap]** 未読バッジ表示 | 1. ヘッダーの通知アイコンを確認<br>2. 未読通知がある場合 | 未読数が数字バッジで表示される（例: 「3」） | **高** |
| 通知・ページネーション | 1. 通知が20件以上ある<br>2. 下部までスクロール | 追加通知が読み込まれる | 中 |
| フォロー通知・フォローバック | 1. 通知タブで「ユーザーAがフォロー」通知を表示<br>2. 「フォローバック」ボタンをクリック | 相互フォロー状態になる | 中 |
| フォロー通知・既フォロー時 | 1. 既にフォロー中のユーザーから通知<br>2. 「フォロー中」状態を表示 | ボタンが「フォロー中」になり、グレーアウト | 中 |

#### プロフィール管理フロー

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| プロフィール表示 | 1. ソーシャルページ > 「みんな」タブ<br>2. 自分のプロフィールセクションを確認 | ユーザー名、表示名が表示される | 中 |
| プロフィール編集・表示名 | 1. プロフィール編集ダイアログを開く<br>2. 表示名を「新しい名前」に変更<br>3. 保存 | プロフィールが更新される | 中 |
| プロフィール編集・ユーザー名 | 1. プロフィール編集で新しいユーザー名を入力<br>2. 保存 | ユーザー名が更新される | 中 |

---

### 異常系

#### エラーハンドリング

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| 認証なしアクセス | 1. ログアウト状態<br>2. ソーシャルAPIを呼び出し | 「認証が必要です」エラーメッセージ表示 | 高 |
| ネットワークエラー | 1. オフラインモードで操作<br>2. フィード読み込みを試行 | 「ネットワークエラー」メッセージ表示、リトライボタン | 中 |
| サーバーエラー500 | 1. APIサーバーエラーシミュレーション<br>2. フィード読み込み | 「エラーが発生しました」メッセージ表示 | 中 |
| 存在しないユーザー検索 | 1. 「xxxxxxxxxxxx」で検索<br>2. 検索実行 | 検索結果が空（「見つかりませんでした」表示） | 中 |
| 自己フォロー試行 | 1. APIで自分のIDをフォロー<br>2. エラー確認 | 「自分をフォローできません」エラー | 高 |
| 既フォロー状態でフォロー | 1. 既にフォロー中のユーザーを再度フォロー | 「既にフォローしています」エラー | 高 |
| レート制限超過 | 1. フォロー操作を短時間に大量実行<br>2. エラー確認 | レート制限エラー（「少しお待ちください」） | 中 |
| 無効なユーザー名で登録 | 1. ユーザー名「abc-def」（ハイフン含む）で設定<br>2. 保存 | バリデーションエラー「英数字とアンダースコアのみ」 | 中 |
| ユーザー名短すぎる | 1. ユーザー名「ab」で設定<br>2. 保存 | 「3文字以上で入力」エラー | 中 |
| ユーザー名長すぎる | 1. ユーザー名を21文字以上入力<br>2. 保存 | 「20文字以内」エラー | 中 |
| ユーザー名既に使用中 | 1. 既に使用されているユーザー名を入力<br>2. 保存 | 「このユーザーIDは既に使用されています」エラー | 高 |
| 表示名に危険文字 | 1. 表示名に `<script>alert('xss')</script>` を入力<br>2. 保存 | バリデーションエラー「使用できない文字」 | 高 |

#### エッジケース

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| 大量フォロー後のフィード表示 | 1. 100以上のユーザーをフォロー<br>2. ソーシャルフィード表示 | ページング処理は正常に機能、パフォーマンス低下なし | 低 |
| 大量通知の既読処理 | 1. 100件以上の通知<br>2. すべて既読処理（未実装） | **[未実装]** 既読バッチ処理は効率的に実行 | **低** |
| フォロー中のユーザーがアカウント削除 | 1. フォロー中のユーザーが削除<br>2. フィード確認 | ユーザー削除時にフォロー関係も自動削除 | 低 |
| 編集中に他ユーザーが共有状態を変更 | 1. 共有投稿を編集中に表示状態を確認 | 画面が正常に同期される（Realtime対応） | 低 |
| 複数達成を同時に取得 | 1. エントリ作成で複数達成条件を同時達成<br>2. 達成テーブルを確認 | すべての達成が作成される | 中 |

---

### 境界値・エッジケース

| テスト名 | ステップ | 期待結果 | 優先度 |
|---------|---------|---------|--------|
| 達成閾値・最小値 | 1. 当日投稿数20まで<br>2. 20回目の投稿で達成判定 | `daily_posts: 20` の達成が作成される | 高 |
| 達成閾値・最大値 | 1. 総投稿数10000を超える設定<br>2. 達成判定 | `total_posts: 10000` で最後の達成作成 | 低 |
| 継続日数・最大値 | 1. 3650日（10年）達成を設定<br>2. 判定 | `streak_days: 3650` の達成が作成される | 低 |
| ページネーション・ちょうど20件 | 1. フィードが厳密に20件<br>2. スクロール | 「次ページ」判定は正確（22件以上で初めて表示） | 中 |
| ページネーション・21件 | 1. フィードが21件<br>2. スクロール | 次ページボタンが有効化 | 中 |
| ユーザー名・最小長3文字 | 1. ユーザー名「abc」で設定 | 成功（最小長ちょうど） | 中 |
| ユーザー名・最大長20文字 | 1. ユーザー名「a」×20文字で設定 | 成功（最大長ちょうど） | 中 |
| 表示名・最大長50文字 | 1. 表示名を「あ」×25文字（50バイト）で設定 | 成功 | 低 |
| 検索キーワード・空文字 | 1. 検索ボックスを空で実行 | 結果なし、または全ユーザー表示 | 低 |
| 検索キーワード・特殊文字 | 1. 検索に「user%abc」（ワイルドカード）を入力 | エスケープ処理により正確に検索（%文字そのものを検索） | 中 |

---

## テスト実行計画

### Phase 1: ユニットテスト (優先度: 高・極高)

- **API関数テスト**: `achievements.ts`, `follows.ts`, `notifications.ts` の主要関数
- **バリデーション**: ユーザー名・表示名・検索エスケープ
- **定数**: 達成閾値、メッセージ生成

**実行コマンド**:
```bash
pnpm test src/features/social/__tests__
pnpm test:watch
pnpm test:coverage
```

### Phase 2: 統合テスト（フック層）

- **フック層テスト**: `use-follow.ts`, `use-social-feed.ts`, `use-celebration.ts`, `use-social-notifications.ts`
- **Realtime購読**: `use-achievement-realtime.ts`

**実行コマンド**:
```bash
pnpm test src/features/social/hooks/__tests__
```

### Phase 3: E2Eテスト

**煙幕テスト（毎PR）**:
- ユーザー検索・フォロー・フォロー解除
- 通知表示
- 達成・お祝い基本フロー

**重要パス（毎PR）**:
- 共有投稿・達成自動作成
- ソーシャルフィード表示・無限スクロール
- お祝い送信・通知作成

**回帰テスト（リリース前）**:
- Realtime更新検証
- プロフィール管理全フロー
- エラーハンドリング・エッジケース

**実行コマンド**:
```bash
pnpm exec playwright test e2e/social*.spec.ts
pnpm exec playwright test --ui
pnpm exec playwright test --retries=2  # CI用
```

### Phase 4: Critical Gap対応テスト

#### ギャップ #1: お祝いプッシュ通知呼び出し漏れ [極高]

**修正前テスト**:
```typescript
test('お祝い送信後、プッシュ通知が送信されない [BUG]', async () => {
  // sendCelebrationPushNotification が呼び出されていないことを確認
  // 修正後は呼び出されるべき
})
```

**修正後テスト**:
```typescript
test('お祝い送信後、プッシュ通知が正常に送信される', async () => {
  // sendCelebrationPushNotification が実行されることを確認
})
```

#### ギャップ #2: markAsRead / markAllAsRead 未実装 [高]

実装後テスト:
```typescript
test('通知をクリックして既読マークが付く', async () => {
  // getSocialNotifications()後に markAsRead(id) を呼び出し
  // is_read フラグが true になることを確認
})

test('全通知既読ボタンで一括既読化', async () => {
  // markAllAsRead() を呼び出し
  // すべての通知の is_read が true になることを確認
})
```

#### ギャップ #3: 未読バッジ未実装 [高]

実装後テスト:
```typescript
test('ヘッダーに未読通知数バッジが表示される', async () => {
  // getUnreadNotificationCount() を呼び出し
  // ヘッダーアイコンに「3」等の数字が表示されることを確認
})

test('全既読処理で未読バッジが消える', async () => {
  // markAllAsRead() 実行後
  // バッジが消える、または「0」になることを確認
})
```

---

## テストカバレッジ目標

| レイヤー | カバレッジ目標 |
|---------|--------------|
| API関数 | 95%以上 |
| フック層 | 90%以上 |
| コンポーネント層 | E2Eで網羅 |
| バリデーション関数 | 100% |

---

## リスク・注意事項

### 高リスク項目

1. **Realtime購読**: `postgres_changes` リスナーの正確性・メモリリーク防止
2. **レート制限**: 同時アクセス時の動作を検証
3. **パーティクルエフェクト**: ブラウザのパフォーマンス（フレームレート）
4. **プッシュ通知**: VAPID キー設定、ブラウザ互換性

### 既知の未実装

1. ✗ `markAsRead()`, `markAllAsRead()` - 既読管理
2. ✗ 未読通知数バッジ - ヘッダー表示
3. ✗ お祝いプッシュ通知の呼び出し - **Critical**

### テスト時に確認すべき項目

- [ ] Supabase RLS ポリシーが正確に適用されているか
- [ ] タイムゾーン（JST）が達成判定に影響していないか
- [ ] キャッシュ無効化が正確に動作しているか
- [ ] エラーメッセージが安全（内部情報露出なし）か
- [ ] スクリーンリーダー対応・キーボード操作が可能か

---

## テストファイル構成

```
e2e/
├── social-search.spec.ts          # ユーザー検索・フォロー
├── social-feed.spec.ts            # ソーシャルフィード・お祝い
├── social-notifications.spec.ts   # 通知・既読管理
├── social-profile.spec.ts         # プロフィール編集
└── fixtures/
    └── social-helpers.ts          # テストヘルパー関数

src/features/social/__tests__/
├── achievements.test.ts           # 達成判定・作成
├── follows.test.ts                # フォロー・アンフォロー
├── notifications.test.ts          # 通知取得・既読
├── timeline.test.ts               # ソーシャルフィード
├── profile.test.ts                # プロフィール管理
├── user-search.test.ts            # ユーザー検索
├── constants.test.ts              # バリデーション・定数
└── hooks/
    ├── use-follow.test.ts
    ├── use-social-feed.test.ts
    ├── use-celebration.test.ts
    ├── use-social-notifications.test.ts
    └── use-achievement-realtime.test.ts
```

